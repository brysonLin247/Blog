## 备战

### JS数据类型

7种基本类型：Undefined、Number、null、Boolean、String、Symbol、BigInt

1种引用类型：Object（包含Function、Array、Date等）

原始数据类型直接存在**栈**中，因为其比较被频繁使用，而引用数据类型同时存在**栈**和**堆**中，在栈中存储了指针，该指针指向堆中该实体的起始地址。

### typeof、instanceof

#### typeof

```javascript
console.log(typeof 2);             // number
console.log(typeof true);          // boolean
console.log(typeof 'str');         // string
console.log(typeof []);            // object []数组的数据类型在typeof中被解释为object
console.log(typeof function(){});  // function
console.log(typeof {});            // object
console.log(typeof undefined);     // undefined
console.log(typeof null);          // object null 的数据类型被typeof解释为object
```

typeof 对于原始类型来说，除了 null 都可以显示正确的类型，但对于对象来说，除了函数都会显示object，无法精确判断是什么类型，故我们可以考虑使用instanceof。

#### instanceof

```javascript
console.log(2 instanceof Number);                    // false
console.log(true instanceof Boolean);                // false 
console.log('str' instanceof String);                // false  
-------------------------------------------------------------
console.log([] instanceof Array);                    // true
console.log(function(){} instanceof Function);       // true
console.log({} instanceof Object);                   // true    
// console.log(undefined instanceof Undefined);
// console.log(null instanceof Null);
```

基本数据不能用instanceof精确判断，instanceof 运算符用来测试一个对象在其原型链中是否存在一个构造函数的 prototype 属性，即判断某一个对象是否为某一数据类型的实例。

### valueOf和toString的坑

```javascript
([]).valueOf();  // []
([]).toString(); // ""
({}).valueOf();  // {}
({}).toString(); // "[object Object]"
```

### 原型/构造函数/实例/原型链

- 原型（prototype）：一个简单的对象，用于实现对象的属性继承。
- 构造函数：可以通过new来新建一个对象的函数。
- 实例：通过构造函数和new创建出来的对象就是实例。

三者的关系：

```javascript
实例.__proto__ === 原型
原型.constructor === 构造函数
构造函数.prototype === 原型
```

- 原型链：原型链是由原型对象组成，每个对象都有`__proto__`属性，指向了创建该对象的构造函数的原型，`__proto__`将对象连接起来组成了原型链。是一个用来**实现继承和共享属性**的有限的对象链。
  - **属性查找机制**：当查找对象的属性时，如果实例对象自身不存在该属性，则沿着原型链往上一级查找，找到则输出，不存在时，则继续沿着原型链往上一级查找，直至最顶级的原型对象`Object.prototype`，如果还是没找到，则输出`undefined`
  - **属性修改机制**：只会修改实例对象本身的属性，如果不存在，则进行添加该属性，如果要修改原型的属性时，则可以用`a.prototype.x = 2`，但是这样会造成所有继承于该对象的实例的属性发生改变。

以下是大致的图：

![image-20210810015019669](/Users/brysonlin/Library/Application Support/typora-user-images/image-20210810015019669.png)

蓝色的线为原型链。

当使用 `obj.__proto__`时，可以理解成返回了 `Object.getPrototypeOf(obj)`。

### 执行上下文

可执行代码类型：全局代码、函数代码、eval代码。

当执行到一个函数时，就会进行“准备工作”，即“执行上下文（execution context）”。JavaScript引擎创建了执行上下文栈（Execution context stack，ECS）来管理上下文。

